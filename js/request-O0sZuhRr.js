import{J as c,K as l,L as u}from"./vendor-CIvD84cs.js";const d=e=>e===void 0||e===""||e===null||typeof e=="string"&&e.trim()==="",p=60*1e3,g={400:"发出的请求有错误，服务器没有进行新建或修改数据的操作。",401:"用户登录超时或没有登录。",403:"用户得到授权，但是访问是被禁止的。",404:"发出的请求针对的是不存在的记录，服务器没有进行操作。",405:"发出的请求方法不被允许。",406:"请求的格式不可得。",410:"请求的资源被永久删除，且不会再得到的。",422:"当创建一个对象时，发生一个验证错误。",500:"服务器发生错误，请检查服务器。",502:"网关错误。",503:"服务不可用，服务器暂时过载或维护。",504:"网关超时。"};let s;const _=(e,r)=>(r.prefix=r.prefix||"/api",r.loading=r.loading||!1,r.errorTips=d(r.errorTips)?!0:r.errorTips,r.loading&&(s=l({message:"加载中...",forbidClick:!0,duration:0})),{url:e,options:{...r,interceptors:!0}}),f=async(e,r)=>e.ok?(r.loading&&s.close(),await e.clone().json()):(e.__code=String(e.status),e.__msg=g[e.status],Promise.reject({response:e})),m=e=>{var i;const{response:r,request:o,type:a}=e;if((i=o.options)!=null&&i.loading&&s.close(),o.options.errorTips){let t;r&&r.__code?t=`<p>错误信息：${r.__msg}</p><p>错误码：${r.__code}</p>`:a==="AbortError"?t="用户取消请求":t="您的网络异常，无法连接到服务器",u({title:"提示",allowHtml:!0,theme:"round-button",message:t})}return Promise.reject(e)},n=c({prefix:"/api",timeout:p,errorHandler:m});n.interceptors.request.use(_);n.interceptors.response.use(f);export{n as r};
